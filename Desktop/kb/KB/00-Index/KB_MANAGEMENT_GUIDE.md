# KB 管理指南

## 0. Obsidian 协作指南

### 0.1 文件格式

- **格式**: Markdown (.md)
- **Front Matter**: YAML 格式，包含元数据
- **链接**: Obsidian 双向链接格式 `[[文件名|显示文本]]`
- **标签**: Obsidian 标签格式 `#标签名`

### 0.2 目录结构

```
KB/
├── .obsidian/          # Obsidian 配置
├── 00-Index/           # 索引和管理指南
├── concepts/           # 概念卡片
├── methods/            # 方法卡片
├── claims/             # 主张卡片
├── engineering/        # 工程卡片
└── deprecated/         # 废弃卡片
```

### 0.3 标签系统

**类型标签**:
- `#type/concept` - 概念卡片
- `#type/method` - 方法卡片
- `#type/claim` - 主张卡片
- `#type/engineering` - 工程卡片

**状态标签**:
- `#status/stable` - 稳定状态
- `#status/draft` - 草稿状态
- `#status/deprecated` - 废弃状态

**置信度标签**:
- `#confidence/high` - 高置信度
- `#confidence/medium` - 中置信度
- `#confidence/low` - 低置信度

### 0.4 链接格式

**Obsidian 双向链接**:
```markdown
[[文件名|显示文本]]
[[文件夹/文件名|显示文本]]
```

**关系边链接**:
```markdown
- **前提**: [[concepts/concept-name|概念名称]] (置信度: high)
- **衍生**: [[concepts/concept-name|概念名称]] (置信度: high)
- **泛化**: [[concepts/concept-name|概念名称]] (置信度: high)
- **特化**: [[concepts/concept-name|概念名称]] (置信度: high)
- **使用**: [[methods/method-name|方法名称]] (置信度: high)
- **替代**: [[concepts/concept-name|概念名称]] (置信度: high)
```

### 0.5 Obsidian 功能使用

**标签面板**:
- 使用标签面板快速过滤卡片
- 点击标签查看所有带该标签的卡片

**反向链接**:
- 在卡片底部查看"反向链接"
- 了解哪些卡片引用了当前卡片

**Graph 视图**:
- 使用 Graph 视图可视化知识图谱
- 查看卡片之间的关系网络

**Canvas**:
- 使用 Canvas 创建概念图谱
- 将相关卡片拖放到 Canvas 中
- 用连线表示关系边

### 0.6 模板使用

**创建新卡片**:
1. 使用 Obsidian 模板功能
2. 选择对应的卡片类型模板
3. 填写内容并保存到对应文件夹

## 1. 废弃处理 (Deprecated Handling)

### 标记规则

- **何时标记为 deprecated**:
  - 概念已过时
  - 方法已被更优方案替代
  - 主张已被证伪
  - 工程实践已不再推荐

- **标记格式**:
  ```yaml
  status: deprecated
  deprecated: true
  replaced_by: "[[concepts/new-concept|新概念]]"  # 必需，指向替代卡片的 Obsidian 链接
  ```

### 替代规则

- **replaced_by 必须指向**:
  - 稳定的替代卡片
  - 具有相同或相似功能的卡片
  - 证据充分的卡片

- **替代卡片要求**:
  - 状态应为 `stable` 或 `draft`
  - 包含完整的证据和说明
  - 与原卡片有明确的关系

## 2. 关系边裁决规则

### 支持 (supports)

- **使用场景**:
  - 证据支持某个主张
  - 数据支持某个结论
  - 实验结果支持某个假设

- **裁决标准**:
  - 证据强度高
  - 逻辑关系明确
  - 相关性强

### 矛盾 (contradicts)

- **使用场景**:
  - 证据反驳某个主张
  - 数据与结论不符
  - 实验结果证伪某个假设

- **裁决标准**:
  - 证据强度高
  - 逻辑关系明确
  - 矛盾点具体

### 泛化 (generalizes)

- **使用场景**:
  - 概念 A 是概念 B 的超集
  - 方法 A 适用于更广泛的场景
  - 主张 A 包含主张 B

- **裁决标准**:
  - 包含关系明确
  - 适用范围更广
  - 逻辑层次清晰

### 特化 (specializes)

- **使用场景**:
  - 概念 A 是概念 B 的子集
  - 方法 A 是方法 B 的具体实现
  - 主张 A 是主张 B 的特例

- **裁决标准**:
  - 包含关系明确
  - 适用范围更窄
  - 逻辑层次清晰

### 使用 (uses)

- **使用场景**:
  - 方法 A 使用了方法 B
  - 工程实践 A 使用了工具 B
  - 实现 A 使用了库 B

- **裁决标准**:
  - 依赖关系明确
  - 使用方式具体
  - 影响范围清晰

### 前提 (prerequisite_of)

- **使用场景**:
  - 概念 A 是理解概念 B 的前提
  - 掌握方法 A 是使用方法 B 的前提
  - 完成步骤 A 是开始步骤 B 的前提

- **裁决标准**:
  - 依赖关系必须
  - 逻辑顺序明确
  - 影响程度高

### 相似 (similar_to)

- **使用场景**:
  - 概念 A 与概念 B 相似但不同
  - 方法 A 与方法 B 解决类似问题
  - 主张 A 与主张 B 观点相近

- **裁决标准**:
  - 相似点明确
  - 差异点具体
  - 比较基准清晰

### 衍生 (derived_from)

- **使用场景**:
  - 概念 A 是从概念 B 衍生而来
  - 方法 A 是在方法 B 的基础上改进
  - 主张 A 是由主张 B 推导得出

- **裁决标准**:
  - 衍生关系明确
  - 改进点具体
  - 证据支持充分

## 3. 原子化原则

### 拆分规则

- **何时拆分**:
  - 一张卡包含多个主题
  - 内容过于复杂，难以理解
  - 不同部分有不同的证据来源
  - 各部分可以独立使用

- **拆分方法**:
  - 按主题拆分
  - 按逻辑关系拆分
  - 按证据来源拆分
  - 确保每个拆分后的卡片都是独立的概念

### 合并规则

- **何时合并**:
  - 多张卡讨论同一主题
  - 内容重叠度高
  - 证据来源相同或相关
  - 合并后更易于理解和使用

- **合并方法**:
  - 保留核心内容
  - 整合证据
  - 明确关系
  - 标记被合并卡片为 deprecated，指向新卡片

## 4. 一致性检查

### 检查项

- **id 唯一性**:
  - 确保所有卡片的 id 唯一
  - 避免 id 冲突
  - 定期检查重复 id

- **断链检查**:
  - 确保所有链接的 target 存在
  - 检查 replaced_by 指向的卡片是否存在
  - 修复或移除断链

- **deprecated 处理**:
  - 确保所有 deprecated 卡片都有 replaced_by
  - 检查 replaced_by 指向的卡片状态
  - 定期清理长期 deprecated 的卡片

- **front matter 完整性**:
  - 确保所有卡片都有完整的 front matter
  - 检查必填字段：type、status、id、title
  - 确保状态标记正确

### 检查工具

- **手动检查**:
  - 定期浏览卡片目录
  - 检查索引页和框架页
  - 验证链接和引用

- **自动化检查**:
  - 编写脚本检查 id 唯一性
  - 编写脚本检查断链
  - 编写脚本检查 front matter 完整性

## 5. 提交策略

### 小步提交

- **提交频率**:
  - 完成一个小任务后立即提交
  - 避免大量变更一次性提交
  - 保持提交的原子性

- **提交信息格式**:
  ```
  [操作类型] 具体内容

  为什么：详细说明变更原因
  影响：说明变更的影响范围
  相关：引用相关卡片或工单
  ```

- **操作类型**:
  - CREATE: 创建新卡片
  - UPDATE: 更新现有卡片
  - LINK: 添加或修改链接
  - MERGE: 合并卡片
  - SPLIT: 拆分卡片
  - DEPRECATE: 标记卡片为废弃

### 架构决策记录 (ADR)

- **何时写 ADR**:
  - 重大架构变更
  - 规则或流程的修改
  - 影响全局的决策
  - 可能引起争议的变更

- **ADR 格式**:
  ```markdown
  # ADR-001: 标题

  ## 状态
  已提议/已接受/已实施/已废弃

  ## 背景
  描述决策的背景和问题

  ## 决策
  描述具体的决策内容

  ## 影响
  描述决策的影响

  ## 替代方案
  描述考虑过的替代方案
  ```

## 6. 质量保证

### 证据要求

- **证据充分的标准**:
  - 引用具体的页码、图号或 slide 编号
  - 包含明确的来源信息
  - 证据与主张直接相关
  - 多个证据相互印证

- **证据不足的处理**:
  - 标记为 `draft`
  - 添加 `TODO(evidence)` 标记
  - 明确需要的证据类型
  - 避免将证据不足的内容标记为 `stable`

### 概念清晰性

- **概念明确的标准**:
  - 定义清晰无歧义
  - 边界明确
  - 与其他概念的关系明确
  - 适用范围明确

- **概念模糊的处理**:
  - 标记为 `draft`
  - 添加 `TODO(clarity)` 标记
  - 明确需要澄清的点
  - 避免在概念模糊的情况下创建关系边

### 关系有效性

- **关系有效的标准**:
  - 关系类型选择正确
  - 关系方向正确
  - 关系有证据支持
  - 关系逻辑合理

- **关系无效的处理**:
  - 移除无效关系
  - 修正关系类型
  - 添加证据支持
  - 避免创建无根据的关系

## 7. 最佳实践

### 日常维护

- **定期检查**:
  - 每周检查一次 deprecated 卡片
  - 每月检查一次断链
  - 每季度检查一次 id 唯一性
  - 每半年检查一次 front matter 完整性

- **更新索引**:
  - 新增卡片后更新索引页
  - 变更卡片状态后更新索引页
  - 合并或拆分卡片后更新索引页
  - 确保索引页与实际卡片一致

### 团队协作

- **沟通规范**:
  - 使用明确的操作类型
  - 提供详细的变更原因
  - 引用相关的卡片和证据
  - 避免模糊的描述

- **决策流程**:
  - 重大变更需团队讨论
  - 复杂合并需多轮审核
  - 关系边裁决需证据支持
  - 废弃处理需明确理由

## 8. 常见问题

### Q: 如何处理证据不足的卡片？
**A**: 标记为 `draft`，添加 `TODO(evidence)`，明确需要的证据类型，避免标记为 `stable`。

### Q: 如何处理概念冲突？
**A**: 分析冲突原因，若是定义差异，创建消歧卡片；若是事实矛盾，标记为 `contradicts` 关系，等待进一步证据。

### Q: 如何处理边界问题？
**A**: 明确卡片的适用范围，添加边界条件说明，避免过度泛化。

### Q: 如何处理重复条目？
**A**: 合并内容重叠度高的卡片，标记被合并卡片为 `deprecated`，指向新卡片。

### Q: 如何确保关系边的有效性？
**A**: 遵循关系边裁决规则，确保关系类型选择正确，关系有证据支持，关系逻辑合理。

## 9. 总结

- **核心原则**:
  - 原子化：一张卡一个主题
  - 证据充分：避免无证据的推断
  - 关系明确：使用标准的关系边类型
  - 维护规范：定期检查和更新

- **目标**:
  - 创建一个结构化、可维护、高质量的知识图谱
  - 支持快速检索和理解
  - 促进知识的共享和创新
  - 适应不断变化的知识环境

